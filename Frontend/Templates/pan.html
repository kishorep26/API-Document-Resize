<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAN Card Format Validation - Income Tax Department</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #8B0000 0%, #A52A2A 100%);
            color: white;
            padding: 40px;
            position: relative;
        }

        .header-content {
            max-width: 800px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .header p {
            opacity: 0.95;
            font-size: 15px;
        }

        .nav-bar {
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breadcrumb {
            color: #666;
            font-size: 14px;
        }

        .breadcrumb a {
            color: #8B0000;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .btn-home {
            background: #8B0000;
            color: white;
            padding: 10px 24px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }

        .btn-home:hover {
            background: #A52A2A;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(139, 0, 0, 0.3);
        }

        .content {
            padding: 40px;
        }

        .info-banner {
            background: #fff3cd;
            border-left: 4px solid #ff9800;
            padding: 16px 20px;
            margin-bottom: 30px;
            border-radius: 4px;
            color: #856404;
        }

        .info-banner strong {
            color: #8B0000;
            display: block;
            margin-bottom: 5px;
        }

        .info-banner p {
            font-size: 14px;
            line-height: 1.6;
        }

        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e0e0e0;
        }

        .upload-area {
            border: 2px dashed #8B0000;
            border-radius: 8px;
            padding: 50px 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fff8f8;
        }

        .upload-area:hover {
            background: #ffe8e8;
            border-color: #A52A2A;
        }

        .upload-area input[type="file"] {
            display: none;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 13px;
            color: #666;
        }

        .preview-image {
            max-width: 100%;
            max-height: 350px;
            margin: 25px 0;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            display: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d0d0d0;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .form-group input:focus {
            outline: none;
            border-color: #8B0000;
            box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-primary {
            background: #8B0000;
            color: white;
        }

        .btn-primary:hover {
            background: #A52A2A;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .divider {
            text-align: center;
            margin: 35px 0;
            color: #999;
            position: relative;
            font-size: 14px;
            font-weight: 500;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 45%;
            height: 1px;
            background: #e0e0e0;
        }

        .divider::before {
            left: 0;
        }

        .divider::after {
            right: 0;
        }

        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 6px;
            display: none;
        }

        .result.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .result.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .result.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .result-title {
            font-weight: 600;
            font-size: 17px;
            margin-bottom: 12px;
        }

        .result-details {
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.6);
            padding: 16px;
            border-radius: 4px;
        }

        .result-details div {
            margin: 10px 0;
            font-size: 14px;
        }

        .confidence-bar {
            width: 100%;
            height: 10px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 12px;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            transition: width 0.5s;
        }

        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 14px 16px;
            border-radius: 6px;
            margin-top: 16px;
            font-size: 13px;
            color: #856404;
        }

        .note strong {
            color: #664d03;
        }

        .holder-type {
            display: inline-block;
            background: #e8f4fd;
            padding: 6px 14px;
            border-radius: 4px;
            font-size: 13px;
            color: #0066cc;
            font-weight: 600;
            margin-top: 5px;
        }

        .footer {
            background: #f8f9fa;
            padding: 25px 40px;
            text-align: center;
            color: #666;
            font-size: 13px;
            border-top: 1px solid #e0e0e0;
        }

        .footer p {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>PAN Card Format Validation</h1>
                <p>Income Tax Department, Government of India</p>
            </div>
        </div>

        <div class="nav-bar">
            <div class="breadcrumb">
                <a href="/">Home</a> / PAN Validation
            </div>
            <a href="/" class="btn-home">Back to Home</a>
        </div>

        <div class="content">
            <div class="info-banner">
                <strong>Important Notice</strong>
                <p>This system performs format validation only. It does NOT verify PAN with the Income Tax Department
                    database. Full verification requires name, date of birth, and OTP authentication on the official IT
                    portal.</p>
            </div>

            <!-- Image Upload Section -->
            <div class="section">
                <div class="section-title">Validate by Image Upload</div>
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-text">Click to upload PAN card image</div>
                    <div class="upload-hint">Supports: JPG, PNG, JPEG (Maximum 16MB)</div>
                    <input type="file" id="fileInput" accept="image/*" onchange="handleFileSelect(event)">
                </div>
                <img id="previewImage" class="preview-image" alt="Preview">

                <button class="btn btn-primary" onclick="verifyPAN()" style="margin-top: 20px;">
                    Validate PAN Card
                </button>

                <div class="note">
                    <strong>Note:</strong> Image validation requires Google Cloud Vision API credentials to be
                    configured. Ensure credentials are properly set up before using this feature.
                </div>
            </div>

            <div class="divider">OR</div>

            <!-- Number Input Section -->
            <div class="section">
                <div class="section-title">Validate by PAN Number</div>
                <div class="form-group">
                    <label for="panNumber">Enter 10-character PAN Number</label>
                    <input type="text" id="panNumber" placeholder="ABCDE1234F" maxlength="10">
                </div>
                <button class="btn btn-primary" onclick="verifyPANNumber()">
                    Validate Format
                </button>
            </div>

            <div id="result" class="result"></div>
        </div>

        <div class="footer">
            <p>&copy; 2024 PAN Validation System | For authorized use only</p>
            <p>This is an unofficial format validation tool - not connected to IT Department database</p>
        </div>
    </div>

    <script>
        let uploadedFile = null;

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                uploadedFile = file;
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('previewImage').src = e.target.result;
                    document.getElementById('previewImage').style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        function verifyPAN() {
            if (!uploadedFile) {
                showResult('Please upload a PAN card image first!', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('file', uploadedFile);

            showResult('Validating PAN card... Please wait.', 'info');

            fetch('/panVerification', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(result => {
                    if (result.valid) {
                        const details = `
                        <div class="result-title">Valid PAN Format</div>
                        <div class="result-details">
                            <div><strong>PAN Number:</strong> ${result.number}</div>
                            <div><strong>Holder Type:</strong> <span class="holder-type">${result.holder_type}</span></div>
                            <div><strong>Confidence Score:</strong> ${result.confidence}%</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${result.confidence}%"></div>
                            </div>
                            <div style="margin-top: 12px;"><em>${result.message}</em></div>
                        </div>
                    `;
                        showResult(details, 'success', true);
                    } else {
                        showResult(`${result.message || 'Invalid or unreadable PAN card'}`, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showResult('Error: ' + error.message, 'error');
                });
        }

        function verifyPANNumber() {
            const number = document.getElementById('panNumber').value.trim().toUpperCase();
            if (!number) {
                showResult('Please enter a PAN number!', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('number', number);

            showResult('Validating PAN format...', 'info');

            fetch('/panVerification', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(result => {
                    if (result.valid) {
                        const details = `
                        <div class="result-title">Valid PAN Format</div>
                        <div class="result-details">
                            <div><strong>PAN Number:</strong> ${result.number}</div>
                            <div><strong>Holder Type:</strong> <span class="holder-type">${result.holder_type}</span></div>
                            <div><strong>Confidence Score:</strong> ${result.confidence}%</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${result.confidence}%"></div>
                            </div>
                            <div style="margin-top: 12px;"><em>${result.message}</em></div>
                        </div>
                    `;
                        showResult(details, 'success', true);
                    } else {
                        showResult(`${result.message || 'Invalid PAN format'}`, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showResult('Error: ' + error.message, 'error');
                });
        }

        function showResult(message, type, isHTML = false) {
            const resultDiv = document.getElementById('result');
            if (isHTML) {
                resultDiv.innerHTML = message;
            } else {
                resultDiv.textContent = message;
            }
            resultDiv.className = `result ${type}`;
            resultDiv.style.display = 'block';
        }

        // Auto-uppercase PAN input
        document.getElementById('panNumber').addEventListener('input', function (e) {
            e.target.value = e.target.value.toUpperCase();
        });
    </script>
</body>

</html>